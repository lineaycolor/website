<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics Testing Dashboard - Lineaycolor</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1, h2 {
            color: #333;
            margin-bottom: 20px;
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 5px;
            border: 1px solid #e0e0e0;
        }
        .status {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: bold;
        }
        .status.active { background: #4CAF50; color: white; }
        .status.inactive { background: #f44336; color: white; }
        .status.warning { background: #ff9800; color: white; }
        button {
            background: #333;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 3px;
            cursor: pointer;
        }
        button:hover {
            background: #555;
        }
        .log {
            background: #f0f0f0;
            padding: 10px;
            margin: 10px 0;
            border-radius: 3px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-left: 3px solid #ddd;
        }
        .test-result.success { border-color: #4CAF50; }
        .test-result.error { border-color: #f44336; }
        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .metric-card {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            text-align: center;
        }
        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }
        .metric-label {
            font-size: 14px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Analytics Testing Dashboard</h1>
        <p>Test and verify all tracking implementations for Lineaycolor</p>

        <!-- Google Analytics 4 Test -->
        <div class="test-section">
            <h2>Google Analytics 4 <span id="ga4-status" class="status inactive">Inactive</span></h2>
            <button onclick="testGA4()">Test GA4 Events</button>
            <button onclick="testEcommerce()">Test E-commerce</button>
            <button onclick="viewDataLayer()">View Data Layer</button>
            <div id="ga4-log" class="log"></div>
        </div>

        <!-- Facebook Pixel Test -->
        <div class="test-section">
            <h2>Facebook Pixel <span id="fb-status" class="status inactive">Inactive</span></h2>
            <button onclick="testFBPixel()">Test FB Events</button>
            <button onclick="testFBEcommerce()">Test FB E-commerce</button>
            <div id="fb-log" class="log"></div>
        </div>

        <!-- Google Tag Manager Test -->
        <div class="test-section">
            <h2>Google Tag Manager <span id="gtm-status" class="status inactive">Inactive</span></h2>
            <button onclick="testGTM()">Test GTM</button>
            <button onclick="debugGTM()">Debug Mode</button>
            <div id="gtm-log" class="log"></div>
        </div>

        <!-- A/B Testing -->
        <div class="test-section">
            <h2>A/B Testing Framework</h2>
            <button onclick="testABTesting()">View Active Tests</button>
            <button onclick="clearABTests()">Clear Test Assignments</button>
            <button onclick="simulateConversion()">Simulate Conversion</button>
            <div id="ab-log" class="log"></div>
        </div>

        <!-- Heatmap Tracking -->
        <div class="test-section">
            <h2>Heatmap & Behavior Tracking</h2>
            <button onclick="showHeatmap()">Show Click Heatmap</button>
            <button onclick="getHeatmapData()">View Tracking Data</button>
            <button onclick="clearHeatmapData()">Clear Data</button>
            <div id="heatmap-log" class="log"></div>
        </div>

        <!-- SEO Tests -->
        <div class="test-section">
            <h2>SEO Implementation</h2>
            <button onclick="testStructuredData()">Test Structured Data</button>
            <button onclick="testMetaTags()">Check Meta Tags</button>
            <button onclick="testSitemap()">Validate Sitemap</button>
            <div id="seo-log" class="log"></div>
        </div>

        <!-- Performance Metrics -->
        <div class="test-section">
            <h2>Performance Metrics</h2>
            <div class="metrics">
                <div class="metric-card">
                    <div class="metric-value" id="page-load-time">-</div>
                    <div class="metric-label">Page Load Time (ms)</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="dom-ready-time">-</div>
                    <div class="metric-label">DOM Ready Time (ms)</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="tracking-scripts">-</div>
                    <div class="metric-label">Tracking Scripts Loaded</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="data-layer-size">-</div>
                    <div class="metric-label">Data Layer Events</div>
                </div>
            </div>
        </div>

        <!-- Test Results Summary -->
        <div class="test-section">
            <h2>Test Results Summary</h2>
            <div id="test-results"></div>
        </div>
    </div>

    <!-- Load all analytics scripts -->
    <script src="/analytics/gtm-container.html"></script>
    <script src="/analytics/analytics-events.js"></script>
    <script src="/analytics/facebook-pixel.js"></script>
    <script src="/analytics/ab-testing.js"></script>
    <script src="/analytics/heatmap-tracking.js"></script>

    <script>
        // Initialize testing
        window.dataLayer = window.dataLayer || [];
        let testResults = [];

        // Check script loading
        function checkScriptStatus() {
            // GA4
            if (window.gtag || window.dataLayer.length > 0) {
                document.getElementById('ga4-status').className = 'status active';
                document.getElementById('ga4-status').textContent = 'Active';
            }

            // Facebook Pixel
            if (window.fbq) {
                document.getElementById('fb-status').className = 'status active';
                document.getElementById('fb-status').textContent = 'Active';
            }

            // GTM
            if (window.google_tag_manager) {
                document.getElementById('gtm-status').className = 'status active';
                document.getElementById('gtm-status').textContent = 'Active';
            }

            updateMetrics();
        }

        // Test GA4
        function testGA4() {
            const log = document.getElementById('ga4-log');
            log.innerHTML = '';

            // Test page view
            if (window.lcAnalytics) {
                window.lcAnalytics.trackPageTiming();
                log.innerHTML += '<div>✓ Page timing tracked</div>';
            }

            // Test custom event
            window.dataLayer.push({
                event: 'test_event',
                test_parameter: 'test_value'
            });
            log.innerHTML += '<div>✓ Test event sent</div>';

            // Show data layer
            log.innerHTML += '<div>Data Layer: ' + JSON.stringify(window.dataLayer.slice(-5), null, 2) + '</div>';
        }

        // Test E-commerce
        function testEcommerce() {
            const log = document.getElementById('ga4-log');
            log.innerHTML = '';

            if (!window.lcAnalytics) {
                log.innerHTML = '<div style="color: red;">Analytics not loaded</div>';
                return;
            }

            // Test view item
            window.lcAnalytics.viewItem({
                id: 'TEST_001',
                name: 'Test Product',
                category: 'Test Category',
                price: 99.99,
                image: '/test.jpg',
                url: '/products/test'
            });
            log.innerHTML += '<div>✓ View item event sent</div>';

            // Test add to cart
            window.lcAnalytics.addToCart({
                id: 'TEST_001',
                name: 'Test Product',
                category: 'Test Category',
                price: 99.99
            }, 2);
            log.innerHTML += '<div>✓ Add to cart event sent</div>';

            // Test purchase
            window.lcAnalytics.purchase({
                id: 'ORDER_TEST_001',
                value: 199.98,
                tax: 20.00,
                shipping: 10.00,
                items: [{
                    id: 'TEST_001',
                    name: 'Test Product',
                    category: 'Test Category',
                    price: 99.99,
                    quantity: 2
                }]
            });
            log.innerHTML += '<div>✓ Purchase event sent</div>';
        }

        // View data layer
        function viewDataLayer() {
            const log = document.getElementById('ga4-log');
            log.innerHTML = '<pre>' + JSON.stringify(window.dataLayer, null, 2) + '</pre>';
        }

        // Test Facebook Pixel
        function testFBPixel() {
            const log = document.getElementById('fb-log');
            log.innerHTML = '';

            if (!window.fbPixelTracker) {
                log.innerHTML = '<div style="color: red;">Facebook Pixel not loaded</div>';
                return;
            }

            // Test view content
            window.fbPixelTracker.viewContent({
                id: 'TEST_001',
                name: 'Test Product',
                category: 'Test Category',
                price: 99.99
            });
            log.innerHTML += '<div>✓ ViewContent event sent</div>';

            // Test custom event
            window.fbPixelTracker.shareProduct({
                id: 'TEST_001',
                name: 'Test Product'
            }, 'email');
            log.innerHTML += '<div>✓ Custom event sent</div>';
        }

        // Test Facebook E-commerce
        function testFBEcommerce() {
            const log = document.getElementById('fb-log');
            log.innerHTML = '';

            if (!window.fbPixelTracker) {
                log.innerHTML = '<div style="color: red;">Facebook Pixel not loaded</div>';
                return;
            }

            // Test complete flow
            window.fbPixelTracker.addToCart({
                id: 'TEST_001',
                name: 'Test Product',
                category: 'Test Category',
                price: 99.99
            }, 1);
            log.innerHTML += '<div>✓ AddToCart sent</div>';

            window.fbPixelTracker.initiateCheckout([{
                id: 'TEST_001',
                name: 'Test Product',
                price: 99.99,
                quantity: 1
            }], 99.99);
            log.innerHTML += '<div>✓ InitiateCheckout sent</div>';

            window.fbPixelTracker.purchase({
                id: 'ORDER_TEST_001',
                value: 99.99,
                items: [{
                    id: 'TEST_001',
                    price: 99.99,
                    quantity: 1
                }]
            });
            log.innerHTML += '<div>✓ Purchase sent</div>';
        }

        // Test GTM
        function testGTM() {
            const log = document.getElementById('gtm-log');
            log.innerHTML = '';

            // Check GTM loaded
            if (window.google_tag_manager) {
                log.innerHTML += '<div>✓ GTM loaded</div>';
                log.innerHTML += '<div>Container ID: ' + Object.keys(window.google_tag_manager)[0] + '</div>';
            } else {
                log.innerHTML += '<div style="color: red;">✗ GTM not loaded</div>';
            }

            // Push test event
            window.dataLayer.push({
                event: 'gtm_test',
                test_time: new Date().toISOString()
            });
            log.innerHTML += '<div>✓ Test event pushed to dataLayer</div>';
        }

        // Debug GTM
        function debugGTM() {
            window.open(window.location.href + '#gtm_debug=x', '_blank');
        }

        // Test A/B Testing
        function testABTesting() {
            const log = document.getElementById('ab-log');
            log.innerHTML = '';

            if (!window.abTesting) {
                log.innerHTML = '<div style="color: red;">A/B Testing not loaded</div>';
                return;
            }

            // Show active tests
            const tests = ['heroMessage', 'ctaButton', 'productGrid', 'pricingDisplay'];
            tests.forEach(testName => {
                const variant = window.abTesting.getVariant(testName);
                if (variant) {
                    log.innerHTML += `<div>Test: ${testName} - Variant: ${variant.variant}</div>`;
                }
            });
        }

        // Clear A/B tests
        function clearABTests() {
            if (window.abTesting) {
                window.abTesting.clearAllTests();
                document.getElementById('ab-log').innerHTML = '<div>✓ All test assignments cleared</div>';
            }
        }

        // Simulate conversion
        function simulateConversion() {
            if (window.abTesting) {
                window.abTesting.trackGoal('add_to_cart', 99.99);
                window.abTesting.trackGoal('purchase', 99.99);
                document.getElementById('ab-log').innerHTML = '<div>✓ Conversion goals tracked</div>';
            }
        }

        // Show heatmap
        function showHeatmap() {
            if (window.heatmapTracker) {
                window.heatmapTracker.showHeatmapOverlay();
                document.getElementById('heatmap-log').innerHTML = '<div>✓ Heatmap overlay displayed for 5 seconds</div>';
            }
        }

        // Get heatmap data
        function getHeatmapData() {
            if (window.heatmapTracker) {
                const data = window.heatmapTracker.generateHeatmapData();
                document.getElementById('heatmap-log').innerHTML = '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
            }
        }

        // Clear heatmap data
        function clearHeatmapData() {
            if (window.heatmapTracker) {
                window.heatmapTracker.clearData();
                document.getElementById('heatmap-log').innerHTML = '<div>✓ Heatmap data cleared</div>';
            }
        }

        // Test structured data
        function testStructuredData() {
            const log = document.getElementById('seo-log');
            log.innerHTML = '';

            const scripts = document.querySelectorAll('script[type="application/ld+json"]');
            log.innerHTML += `<div>Found ${scripts.length} structured data blocks</div>`;

            scripts.forEach((script, index) => {
                try {
                    const data = JSON.parse(script.textContent);
                    log.innerHTML += `<div>✓ Block ${index + 1}: ${data['@type']}</div>`;
                } catch (e) {
                    log.innerHTML += `<div style="color: red;">✗ Block ${index + 1}: Invalid JSON</div>`;
                }
            });
        }

        // Test meta tags
        function testMetaTags() {
            const log = document.getElementById('seo-log');
            log.innerHTML = '';

            const requiredMeta = [
                'description',
                'og:title',
                'og:description',
                'og:image',
                'twitter:card'
            ];

            requiredMeta.forEach(name => {
                const meta = document.querySelector(`meta[name="${name}"], meta[property="${name}"]`);
                if (meta) {
                    log.innerHTML += `<div>✓ ${name}: ${meta.content.substring(0, 50)}...</div>`;
                } else {
                    log.innerHTML += `<div style="color: red;">✗ ${name}: Missing</div>`;
                }
            });
        }

        // Test sitemap
        function testSitemap() {
            const log = document.getElementById('seo-log');
            log.innerHTML = '<div>Checking sitemap...</div>';

            fetch('/sitemap.xml')
                .then(response => {
                    if (response.ok) {
                        log.innerHTML += '<div>✓ Sitemap found at /sitemap.xml</div>';
                    } else {
                        log.innerHTML += '<div style="color: red;">✗ Sitemap not found</div>';
                    }
                })
                .catch(error => {
                    log.innerHTML += '<div style="color: red;">✗ Error checking sitemap</div>';
                });
        }

        // Update metrics
        function updateMetrics() {
            // Page load time
            if (window.performance) {
                const timing = window.performance.timing;
                const loadTime = timing.loadEventEnd - timing.navigationStart;
                const domTime = timing.domContentLoadedEventEnd - timing.navigationStart;
                
                document.getElementById('page-load-time').textContent = loadTime || '-';
                document.getElementById('dom-ready-time').textContent = domTime || '-';
            }

            // Tracking scripts
            let scriptsLoaded = 0;
            if (window.gtag || window.dataLayer.length > 0) scriptsLoaded++;
            if (window.fbq) scriptsLoaded++;
            if (window.google_tag_manager) scriptsLoaded++;
            if (window.abTesting) scriptsLoaded++;
            if (window.heatmapTracker) scriptsLoaded++;
            
            document.getElementById('tracking-scripts').textContent = scriptsLoaded;
            
            // Data layer size
            document.getElementById('data-layer-size').textContent = window.dataLayer.length;
        }

        // Initialize on load
        window.addEventListener('load', () => {
            setTimeout(checkScriptStatus, 1000);
        });
    </script>
</body>
</html>